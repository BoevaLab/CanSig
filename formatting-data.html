
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Input data format &#8212; CanSig  documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'formatting-data';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CanSig for Pythonists" href="cansig-for-python-coders.html" />
    <link rel="prev" title="Data interpretation" href="interpretation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">CanSig  documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="preprocessing.html">
                        Preprocessing
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="pipeline-advanced.html">
                        Advanced pipeline usage
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="interpretation.html">
                        Data interpretation
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="#">
                        Input data format
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="cansig-for-python-coders.html">
                        CanSig for Pythonists
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="troubleshooting.html">
                        Troubleshooting / Checklist
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="contributing.html">
                        Contributing
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/BoevaLab/CanSig" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="preprocessing.html">
                        Preprocessing
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="pipeline-advanced.html">
                        Advanced pipeline usage
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="interpretation.html">
                        Data interpretation
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="#">
                        Input data format
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="cansig-for-python-coders.html">
                        CanSig for Pythonists
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="troubleshooting.html">
                        Troubleshooting / Checklist
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="contributing.html">
                        Contributing
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/BoevaLab/CanSig" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="input-data-format">
<span id="formatting"></span><h1>Input data format<a class="headerlink" href="#input-data-format" title="Permalink to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial is meant for researchers with little to no experience with coding.</p>
</div>
<p>We highly recommend you use our preprocessing module (see <a class="reference internal" href="preprocessing.html#preprocessing"><span class="std std-ref">Preprocessing</span></a>) to preprocess your data.
This will ensure the data you input in CanSig is in the correct format and will enable smooth use of functionalities like differential CNV analysis.</p>
<p>However, we support running the pipeline without using our module.
CanSig takes an .h5ad object as input. This tutorial will walk you through obtaining this format using more a more widespread data format (.csv).</p>
<p>You must have:</p>
<ul class="simple">
<li><p>expression.csv, matrix containing the raw counts (eg UMI), with cell IDs as first column and gene IDs as first row.</p></li>
<li><p>observation.csv, matrix containing information about the cells. Only mandatory information is the batch ID, but this matrix can contain known signatures pre-scored, cell type annotation, number of counts in the cell, etc.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a .txt file, this function should also work, if your file is organized in the same manner as a .csv file, meaning that there is a consistent separator (be it tab or comma) that separates your data into columns.</p>
</div>
<p>If you are using CanSig as a model, you will need data for malignant and for non-malignant cells. You should thus have two expression matrices (eg expression-malignant.csv and expression-non-malignant.csv) and two associated observation matrices. You should then run the following procedure both for the malignant and non-malignant matrices.
If you are using scVI as a model, you will only need data for malignant cells.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use any type of gene annotation for your genes as long as your are consistent throughout the pipeline. In particular, GSEA will only work with either Official Gene ID or Entrez. If you have ENSEMBL annotations, we recommend you map them to Official Gene ID before.</p>
</div>
<p>Here is an example of what the beginning of the expression matrix should look like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>            <span class="n">EEA1</span>  <span class="n">CCDC107</span>  <span class="n">ZNF442</span>  <span class="n">THOC2</span>    <span class="n">GPX3</span>   <span class="n">ASPHD2</span>   <span class="n">GINS1</span>
<span class="n">cell_1</span>      <span class="mf">0.0</span>     <span class="mf">1.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">3.0</span>     <span class="mf">0.0</span>     <span class="mf">1.0</span>
<span class="n">cell_2</span>      <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
<span class="n">cell_3</span>      <span class="mf">0.0</span>     <span class="mf">4.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">2.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
<span class="n">cell_4</span>      <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">3.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
<span class="n">cell_5</span>      <span class="mf">0.0</span>     <span class="mf">2.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
<span class="n">cell_6</span>      <span class="mf">1.0</span>     <span class="mf">1.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">1.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
<span class="n">cell_7</span>      <span class="mf">1.0</span>     <span class="mf">1.0</span>     <span class="mf">0.0</span>     <span class="mf">2.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
<span class="n">cell_8</span>      <span class="mf">2.0</span>     <span class="mf">1.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
</pre></div>
</div>
<p>Here is an example of what the beginning of the observation matrix should look like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">batch</span>       <span class="n">n_counts</span>   <span class="n">n_genes</span>  <span class="n">pct_counts_mt</span>
<span class="n">cell_1</span>  <span class="n">P28T</span>        <span class="mf">39525.0</span>    <span class="mi">4551</span>     <span class="mf">0.2504744</span>
<span class="n">cell_2</span>  <span class="n">P28T</span>        <span class="mf">18224.0</span>    <span class="mi">3826</span>     <span class="mf">0.548727</span>
<span class="n">cell_3</span>  <span class="n">P30T</span>        <span class="mf">10079.0</span>    <span class="mi">2685</span>     <span class="mf">0.00992162</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The only required column in the observation matrix of malignant cells is batch. However, if you are also using a non-malignant dataset, there should also be a celltype column.</p>
</div>
<p>If your data is formatted as previously explained, then you can simply go into the directory that contains your data and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m cansig.run.format --expression expression.csv \
                                        --observation observation.csv \
                                        --filename full_data
</pre></div>
</div>
<p>This will save a file called “full_data.h5ad” in the current directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure you either call the function from the directory where the data is stored or provide the full path to the data in the above call.
In which case, the call would look something like this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m cansig.run.format --expression path/to/expression.csv \
                                        --observation path/to/observation.csv \
                                        --filename full_data
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are calling this function twice, don’t forget to change the <code class="docutils literal notranslate"><span class="pre">--filename</span></code> argument!</p>
</div>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="interpretation.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Data interpretation</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="cansig-for-python-coders.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">CanSig for Pythonists</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/formatting-data.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022 CanSig team.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.2.3.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>